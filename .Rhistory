# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot() + geom_sf() +
theme_light()
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot() +
geom_sf() +
theme_light() +
labs(title = "Venezuela in GRID Form")
## throw out water tiles: places with no gwno == not countries
prio_land =
prio %>%
filter(!is.na(gwno))
nrow(prio_land)/nrow(prio)
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "nlights_calib_mean")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2014) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
head(prio)
## throw out water tiles: places with no gwno == not countries
prio_land =
prio %>%
drop_na(gwno)
View(prio_land)
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "nlights_calib_mean"))
View(prio_year)
prio_year %>% arrange(gwno, year) %>% View()
prio_year %>% arrange(gwno, year) %>% filter(year == 2014) %>% View()
prio_year %>% arrange(gwno, year) %>% filter(year == 2012) %>% View()
knitr::opts_chunk$set(echo = TRUE, warning = F,message = F)
library(tidyverse)
library(sf)
library(spdep)
library(rgdal)
library(vroom)
# read data
prio = st_read(dsn = "/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/priogrid_cellshp",
layer = "priogrid_cell",
stringsAsFactors = F) %>%
mutate(gid = as.character(gid))
prio %>%
head()
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "nlights_calib_mean")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2012) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
head(prio)
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot() +
geom_sf() +
theme_light() +
labs(title = "Venezuela in GRID Form")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = nlights_calib_mean)) +
geom_sf() +
theme_light() +
labs(title = "Venezuela in GRID Form")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = nlights_calib_mean)) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "nlights_mean")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2012) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv"
)
View(prio_year)
View(prio_year)
names(prio_year)
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "pop_gpw_sum")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2012) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
View(prio_year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
head(prio)
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
View(prio)
knitr::opts_chunk$set(echo = TRUE, warning = F,message = F)
library(tidyverse)
library(sf)
library(spdep)
library(rgdal)
library(vroom)
# read data
prio = st_read(dsn = "/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/priogrid_cellshp",
layer = "priogrid_cell",
stringsAsFactors = F) %>%
mutate(gid = as.character(gid))
prio %>%
head()
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "pop_gpw_sum")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2012) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
head(prio)
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
prio %>%
filter(gwno == 101)
knitr::opts_chunk$set(echo = TRUE, warning = F,message = F)
library(tidyverse)
library(sf)
library(spdep)
library(rgdal)
library(vroom)
# read data
prio = st_read(dsn = "/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/priogrid_cellshp",
layer = "priogrid_cell",
stringsAsFactors = F) %>%
mutate(gid = as.character(gid))
prio %>%
head()
# read in PRIO yearly data
prio_year =
# just want gid and gwno to identify water
vroom("/Users/JuamnTellez/Dropbox/papers/State Origins and Violence/Data/prio-grid-2/prio-grid-yearly.csv",
col_select = c("gid", "gwno", "year", "pop_gpw_sum")) %>%
# we got multipe years of data and changing country,
# so i'm arbitrarily picking all countries in most recent year
filter(year == 2005) %>%
mutate(gid = as.character(gid)) %>%
select(-year)
# merge in gwno to identify country grids
prio = left_join(prio, prio_year)
head(prio)
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "Venezuela in GRID Form")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 100) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_light() +
scale_fill_viridis_c() +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_light() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_blank() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela for sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
ggplot(aes(fill = log(pop_gpw_sum))) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela",
fill = "Logged population")
prio %>%
filter(gwno == 101) %>% pull(pop_gpw_sum) %>% summary()
prio %>%
filter(gwno == 101) %>% pull(pop_gpw_sum) %>% cut_number(5)
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 5)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno") +
labs(title = "GRID-level population in Venezuela",
fill = "Logged population")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 5)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno") +
labs(title = "GRID-level population in Venezuela",
fill = "Logged population")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno") +
labs(title = "GRID-level population in Venezuela",
fill = "Logged population")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno") +
labs(title = "GRID-level population in Venezuela") +
theme(legend.position = "none")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 20)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno") +
labs(title = "GRID-level population in Venezuela") +
theme(legend.position = "none")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 20)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela") +
theme(legend.position = "none")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela") +
theme(legend.position = "none")
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10))
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = scales::comma(cut_number(pop_gpw_sum, 10))) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = scales::comma(cut_number(pop_gpw_sum, 10))
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = scales::comma(cut_number(pop_gpw_sum, 10))
prio %>%
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10))
?cut_number
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10, labels = FALSE))
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum/1000, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_cut)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_d(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9, values = c(0, 1e3, 1e4, 1e5, 1e6)) +
labs(title = "GRID-level population in Venezuela")
?scale_fill_viridis_c
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9, trans = "log10") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9, trans = "log10", "Logged Population") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno", end = .9, trans = "log10", name = "Logged Population") +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno",
end = .9,
trans = "log10",
labels = scales::comma) +
labs(title = "GRID-level population in Venezuela")
# plot Venezuela as sanity check
prio %>%
filter(gwno == 101) %>%
#mutate(pop_cut = cut_number(pop_gpw_sum, 10)) %>%
ggplot(aes(fill = pop_gpw_sum)) +
geom_sf() +
theme_minimal() +
scale_fill_viridis_c(option = "inferno",
end = .9,
trans = "log10",
labels = scales::comma,
name = "") +
labs(title = "GRID-level population in Venezuela")
# convert back to sp object to use nice sp dep functions
earth_sp = as(earth, Class = "Spatial")
# get neighbors
nb = poly2nb(earth_sp,
queen = FALSE,
row.names = earth$gid)
# convert back to sp object to use nice sp dep functions
prio_land_sp = as(prio_land, Class = "Spatial")
# get neighbors
nb = poly2nb(prio_land_sp,
queen = FALSE,
row.names = prio_land_sp$gid)
